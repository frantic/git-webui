<!DOCTYPE html>
<html>
<head>
  <title>Git WebUI</title>
  <script type="text/javascript" src="/lib/react.js"></script>
  <script type="text/javascript" src="/lib/jsx-transform.js"></script>
  <script type="text/javascript">
    function loadLog(cb) {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          var log = JSON.parse(xhr.responseText);
          cb(log);
        }
      }
      xhr.open('GET', '/log');
      xhr.send();
    }
  </script>
  <script type="text/jsx">
    var Root = React.createClass({
      getInitialState: function() {
        return { log: [] };
      },

      componentDidMount: function() {
        loadLog(this.handleLog);
      },

      handleLog: function(log) {
        this.setState({log: log});
      },

      render: function() {
        var items = this.state.log.map(function(item) {
          return <div key={item.sha1}>{item.sha1} {item.message}</div>;
        })
        return <pre>{items}</pre>;
      }
    });
    React.render(<Root />, document.getElementById('root'));
  </script>
</head>
<body>
  <div id="root"></div>
</body>
</html>
